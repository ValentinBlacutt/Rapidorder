<!-- Views/Home/Index.cshtml -->
@model Restaurante.Models.ViewModels.HomeViewModel
@{
    ViewData["Title"] = "Inicio";
}

<link rel="stylesheet" href="~/css/home.css" />

<!-- Hero Section -->
<div class="hero-section text-center">
    <div class="container">
        <h1 class="display-3">🍔 Bienvenido a Nuestro Restaurante</h1>
        <p class="lead">Descubre nuestros deliciosos platillos y combos especiales preparados con amor</p>
    </div>
</div>

<div class="main-container">
    <!-- Productos Destacados -->
    <section class="mb-5 fade-in">
        <h2 class="section-header">
            <i class="fas fa-star text-warning"></i>
            Productos Destacados
        </h2>
        <div class="row g-4">
            @foreach (var producto in Model.ProductosDestacados)
            {
                <div class="col-lg-3 col-md-4 col-sm-6">
                    <div class="product-card">
                        <div class="product-image-container">
                            <img src="@(producto.ImagenUrl ?? "/images/placeholder.jpg")"
                                 class="product-image"
                                 alt="@producto.Nombre"
                                 loading="lazy">
                        </div>
                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title">@producto.Nombre</h5>
                            <p class="card-text">@producto.Descripcion</p>

                            <div class="mb-3">
                                <!-- Espacio para badges si los necesitas -->
                            </div>

                            <div class="mt-auto">
                                <div class="mb-3">
                                    <p class="price-tag">S/. @producto.Precio.ToString("0.00")</p>
                                </div>

                                @if (producto is Hamburguesa)
                                {
                                    <a href="@Url.Action("PersonalizarHamburguesa", "Personalizacion", new { id = producto.Id })"
                                       class="btn btn-custom-primary w-100">
                                        <i class="fas fa-utensils me-2"></i>Personalizar y Agregar
                                    </a>
                                }
                                else if (producto is Bebida)
                                {
                                    <a href="@Url.Action("PersonalizarBebida", "PersonalizacionBebida", new { id = producto.Id })"
                                       class="btn btn-custom-info w-100">
                                        <i class="fas fa-glass-whiskey me-2"></i>Elegir Tamaño
                                    </a>
                                }
                                else if (producto is Papas)
                                {
                                    <a href="@Url.Action("PersonalizarPapas", "PersonalizacionPapas", new { id = producto.Id })"
                                       class="btn btn-custom-primary w-100"
                                       style="background: linear-gradient(135deg, #2ed573 0%, #7bed9f 100%); box-shadow: 0 6px 20px rgba(46, 213, 115, 0.35);">
                                        <i class="fas fa-french-fries me-2"></i>Personalizar y Agregar
                                    </a>
                                }
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    </section>

    <!-- Combos Especiales -->
    <section class="mb-5 fade-in">
        <h2 class="section-header">
            <i class="fas fa-gift text-success"></i>
            Combos Especiales
        </h2>
        <div class="row g-4">
            @foreach (var combo in Model.Combos)
            {
                <div class="col-lg-4 col-md-6">
                    <div class="combo-card">
                        <span class="combo-badge">¡OFERTA!</span>
                        <div class="product-image-container">
                            <img src="@(combo.ImagenUrl ?? "/images/combo-placeholder.jpg")"
                                 class="product-image"
                                 alt="@combo.Nombre"
                                 loading="lazy">
                        </div>
                        <div class="combo-body">
                            <h5 class="card-title">@combo.Nombre</h5>
                            <p class="card-text">@combo.Descripcion</p>

                            <div class="mt-auto">
                                <p class="price-tag">S/. @combo.Precio.ToString("0.00")</p>
                                <a href="@Url.Action("PersonalizarCombo", "PersonalizacionCombo", new { id = combo.Id })"
                                   class="btn btn-custom-success w-100">
                                    <i class="fas fa-utensils me-2"></i>Personalizar Combo
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    </section>
</div>

@section Scripts {
    <script>
        $(document).ready(function() {
            // Agregar producto al carrito
            $('.agregar-carrito').click(function() {
                var productoId = $(this).data('producto-id');
                agregarAlCarrito(productoId, 'producto');
            });

            // Agregar combo al carrito
            $('.agregar-combo').click(function() {
                var comboId = $(this).data('combo-id');
                agregarAlCarrito(comboId, 'combo');
            });

            function agregarAlCarrito(id, tipo) {
                $.post('/Carrito/' + (tipo === 'producto' ? 'AgregarProducto' : 'AgregarCombo'),
                    tipo === 'producto' ? { productoId: id } : { comboId: id },
                    function(response) {
                        if (response.success) {
                            // Notificación más elegante
                            mostrarNotificacion('¡Agregado al carrito!', 'success');
                            actualizarContadorCarrito();
                        } else {
                            mostrarNotificacion('Error: ' + response.message, 'error');
                        }
                    }
                );
            }

            function mostrarNotificacion(mensaje, tipo) {
                // Implementa aquí tu sistema de notificaciones preferido
                // Por ahora usamos alert, pero puedes usar toastr, sweetalert, etc.
                alert(mensaje);
            }

            // Lazy loading de imágenes
            if ('IntersectionObserver' in window) {
                const imageObserver = new IntersectionObserver((entries, observer) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const img = entry.target;
                            img.src = img.dataset.src;
                            img.classList.add('fade-in');
                            observer.unobserve(img);
                        }
                    });
                });

                document.querySelectorAll('img[data-src]').forEach(img => {
                    imageObserver.observe(img);
                });
            }
        });
    </script>
}